1
00:00:19,286 --> 00:00:23,824
欢迎来到自动布局迷宫 第一部分


2
00:00:26,860 --> 00:00:27,995
哇 


3
00:00:28,629 --> 00:00:29,830
大家早上好


4
00:00:29,897 --> 00:00:30,731
早上好


5
00:00:31,031 --> 00:00:32,198
我是杰森·姚


6
00:00:32,266 --> 00:00:33,834
是界面设计器工程师


7
00:00:33,901 --> 00:00:36,703
我和iOS键盘工程师卡西亚
一起给大家来介绍


8
00:00:37,037 --> 00:00:39,072
《欢迎来到自动布局迷宫》


9
00:00:40,374 --> 00:00:43,443
作为开发人员
大家都想设计出


10
00:00:43,510 --> 00:00:45,512
令用户惊喜的漂亮
且出彩的app


11
00:00:46,213 --> 00:00:49,049
布局出色会让你的
app棋高一着


12
00:00:49,116 --> 00:00:51,318
用户也会对你
大加赞赏


13
00:00:51,952 --> 00:00:54,454
需要面对所有
不同的设备


14
00:00:54,521 --> 00:00:57,324
配置以及
多任务处理


15
00:00:57,424 --> 00:01:00,360
和本地化 
要面面俱到确有难度


16
00:01:00,627 --> 00:01:02,963
幸好 有个工具
可以帮忙Auto Layout


17
00:01:08,168 --> 00:01:11,738
Auto Layout从本质而言
就是将大量的数据


18
00:01:12,039 --> 00:01:16,143
加以约束
将其转化为等式


19
00:01:16,476 --> 00:01:18,846
运用线性代数
构成一系列框架


20
00:01:20,447 --> 00:01:23,016
可以实现
所规定的布局


21
00:01:23,450 --> 00:01:25,819
现在有了Auto Layout
你会发现它的强大


22
00:01:25,886 --> 00:01:30,891
和灵活功能 不过貌似
有时也会有些神秘


23
00:01:31,491 --> 00:01:33,894
所以才会安排
今天的讲座 发现并


24
00:01:33,961 --> 00:01:36,129
揭开了解Auto Layout的
神秘面纱所在


25
00:01:37,965 --> 00:01:42,002
我们会介绍若干
诀窍和技巧 


26
00:01:42,503 --> 00:01:47,407
通过学习 帮助大家
节约开发时间


27
00:01:47,708 --> 00:01:49,042
让大家不至于沮丧


28
00:01:49,109 --> 00:01:50,110
现在就开始


29
00:01:50,611 --> 00:01:53,647
如果不了解Auto Layout
无论你是新人还是老手


30
00:01:53,714 --> 00:01:55,315
都有必要
参加本次讲座


31
00:01:57,284 --> 00:01:59,753
如果需要温故知新
可以看看WWDC 


32
00:02:00,254 --> 00:02:01,121
以往的讲座


33
00:02:01,989 --> 00:02:03,190
我们来看
概要部分


34
00:02:05,125 --> 00:02:06,360
讲座分两部分


35
00:02:06,693 --> 00:02:09,329
上午的半天讲座
现在就开始


36
00:02:09,530 --> 00:02:12,866
下午的部分是在
同一地点 晚些时候开始


37
00:02:14,101 --> 00:02:15,903
我们现在开始
了解第一个谜题


38
00:02:16,737 --> 00:02:20,207
第一谜题
可维护布局


39
00:02:22,509 --> 00:02:24,378
现在 如果你在用
Auto Layout


40
00:02:24,444 --> 00:02:27,080
那么很快就会发现
需要涉及到约束内容


41
00:02:27,648 --> 00:02:31,652
设想在两个视图之间
建立关系


42
00:02:32,252 --> 00:02:35,022
可以在一边加标签
在另一边加包裹


43
00:02:35,355 --> 00:02:39,793
确定间距是多少
在父视图中


44
00:02:39,860 --> 00:02:40,961
具体在什么位置


45
00:02:41,028 --> 00:02:43,797
并沿着基线
做出美观的安排


46
00:02:44,698 --> 00:02:47,234
现在无论规格变动的是
运行时间或是


47
00:02:47,801 --> 00:02:50,737
设计时间
Auto Layout都可以实现


48
00:02:53,207 --> 00:02:54,541
设想一个更为复杂的例子


49
00:02:55,108 --> 00:02:56,210
这里是App Store


50
00:02:56,276 --> 00:02:58,078
还有GarageBand 
显示为app


51
00:02:58,245 --> 00:02:59,580dle
其中有若干
控件


52
00:03:00,247 --> 00:03:03,517
上端有标签
和一些按钮


53
00:03:03,584 --> 00:03:06,587
一侧还有图标 
中间是段控件


54
00:03:06,653 --> 00:03:09,122
在底部是
几个预览图像


55
00:03:09,823 --> 00:03:11,925
可以使用Auto Layout
把内容铺开


56
00:03:12,292 --> 00:03:13,794
适应不同的大小


57
00:03:14,027 --> 00:03:15,963
约束大致
是这个样子


58
00:03:20,467 --> 00:03:22,469
现在来看
可维护部分


59
00:03:23,904 --> 00:03:26,540
假设你不是
创建布局的


60
00:03:26,607 --> 00:03:27,508
开发人员


61
00:03:28,342 --> 00:03:30,544
可是老板
过来说


62
00:03:30,711 --> 00:03:34,047
我要一个新的控件
就在基础内容下边


63
00:03:34,214 --> 00:03:35,382
在星级评分上面


64
00:03:35,949 --> 00:03:36,984
那该怎么动手开始呢？


65
00:03:37,818 --> 00:03:39,453
你可能要查看
这一区域的


66
00:03:39,520 --> 00:03:41,188
控件
看看约束规则


67
00:03:41,622 --> 00:03:44,191
试着插入
自己的按钮 打乱布局


68
00:03:44,591 --> 00:03:46,660
再重新组合
希望没有问题


69
00:03:47,995 --> 00:03:49,630
正如大家所想
还有更为


70
00:03:49,730 --> 00:03:51,865
可维护的方法
就是Stack View


71
00:03:53,467 --> 00:03:57,771
这是iOS 9的新增功能
比以前Mac上还要好用


72
00:03:58,505 --> 00:04:00,974
Stack View能让你
线性安排视图


73
00:04:02,509 --> 00:04:04,444
Stack View在两个平台上
有校验位


74
00:04:06,079 --> 00:04:08,282
是在Auto Layout
上方搭建


75
00:04:10,017 --> 00:04:13,854
可以管理子视图的
约束


76
00:04:13,921 --> 00:04:15,722
当加入用户约束时
你就不用再管理


77
00:04:15,789 --> 00:04:17,257
就可运行顺畅


78
00:04:18,858 --> 00:04:22,529
可以有水平或
垂直定位或是坐标轴


79
00:04:23,797 --> 00:04:25,532
以及其他
自定义属性


80
00:04:25,966 --> 00:04:27,067
比如对齐等等


81
00:04:28,202 --> 00:04:30,404
这里有全部的
水平堆栈视图


82
00:04:30,470 --> 00:04:32,539
这里是上端
中心 底部


83
00:04:32,739 --> 00:04:33,707
和基线对齐的示例


84
00:04:33,774 --> 00:04:35,042
还有其他的
对齐功能


85
00:04:35,843 --> 00:04:39,012
以及矢量堆栈视图


86
00:04:39,479 --> 00:04:42,883
这里是填充示例 
左对齐 居中和右对齐


87
00:04:44,051 --> 00:04:47,054
现在 需要注意
一个属性


88
00:04:47,120 --> 00:04:49,223
相当酷
就是分布属性


89
00:04:49,289 --> 00:04:51,358
这也是NSStackView
和iOS 9的


90
00:04:51,425 --> 00:04:53,427
新功能


91
00:04:54,561 --> 00:04:57,831
这可以实现
沿着坐标轴分布


92
00:04:58,832 --> 00:05:02,202
还可以完成
相当复杂的行为


93
00:05:02,436 --> 00:05:04,338
不需要理会
任何约束规则


94
00:05:05,072 --> 00:05:06,473
这里是填充示例


95
00:05:07,241 --> 00:05:08,575
这样我们来
填充堆栈视图


96
00:05:09,343 --> 00:05:12,045
等量填充 
按比例填充


97
00:05:12,112 --> 00:05:15,349
根据子视图内容大小
以及等距


98
00:05:15,482 --> 00:05:17,384
还有其他
分布选项


99
00:05:18,051 --> 00:05:21,688
可以搭建 谢谢 


100
00:05:26,226 --> 00:05:28,228
可以从堆栈视图
来搭建 我给大家


101
00:05:28,295 --> 00:05:30,397
Interface Builder
内部的演示


102
00:05:40,674 --> 00:05:41,508
好


103
00:05:41,575 --> 00:05:42,676
要装载Xcode 


104
00:05:43,410 --> 00:05:45,913
加上视图控制器
设置场景


105
00:05:45,979 --> 00:05:47,047
我只需从
Object Library


106
00:05:47,114 --> 00:05:48,515
和Media Library


107
00:05:48,582 --> 00:05:50,350
拖拽一系列整包
控件和图像


108
00:05:50,417 --> 00:05:52,286
大家可以看到
这些都是顶层标签


109
00:05:52,352 --> 00:05:53,420
按钮和图像


110
00:05:53,987 --> 00:05:57,558
现在我们继续
把这些加入布局


111
00:05:58,492 --> 00:06:02,696
首先来选择
按钮和标签


112
00:06:03,096 --> 00:06:04,965
大家要注意
在IB画布上的


113
00:06:05,032 --> 00:06:07,935
新按钮Stack
View按钮上的Embed 


114
00:06:08,435 --> 00:06:11,705
点击它的时候
就可以生成堆栈视图


115
00:06:11,805 --> 00:06:14,641
确定我的对齐安排
和坐标轴


116
00:06:21,315 --> 00:06:23,150
现在来调整
属性


117
00:06:23,483 --> 00:06:26,420
可以看到Property Inspector
在这里


118
00:06:29,389 --> 00:06:32,192
还有坐标轴
对齐方式 分布


119
00:06:32,259 --> 00:06:33,493
间距以及
部分选项


120
00:06:33,560 --> 00:06:35,362
大家会注意到
这里还有个加号


121
00:06:35,762 --> 00:06:38,599
可以把iOS 9的尺寸
变成可类化


122
00:06:40,567 --> 00:06:44,037
现在我们继续
来调整对齐安排


123
00:06:44,104 --> 00:06:47,875
以前用过Auto Layout
来处理约束功能的朋友


124
00:06:47,941 --> 00:06:50,544
会注意到
我们现在只需


125
00:06:50,611 --> 00:06:53,647
把它从右对齐
改为左对齐


126
00:06:55,082 --> 00:06:56,183
不需要碰任何约束


127
00:06:57,050 --> 00:07:00,220
我们继续 将整包的其他
视图在这里做堆栈


128
00:07:00,287 --> 00:07:03,557
我会继续
点击我的评级


129
00:07:04,525 --> 00:07:08,095
堆栈是水平方向
创建水平堆栈视图


130
00:07:08,161 --> 00:07:10,130
那我继续
把这个拖拽到


131
00:07:10,664 --> 00:07:11,598
第一个堆栈视图


132
00:07:12,666 --> 00:07:16,470
现在来选择
图标和头部


133
00:07:17,938 --> 00:07:20,140
点击Stack View按钮
最后


134
00:07:20,707 --> 00:07:24,711
前三个控件和
我的布局就基本搞定


135
00:07:31,718 --> 00:07:33,854
我们来继续
调整部分属性


136
00:07:33,921 --> 00:07:35,622
选中上层
堆栈视图


137
00:07:36,456 --> 00:07:39,626
我来继续
先调整对齐方式


138
00:07:39,693 --> 00:07:43,597
不是居中 而是填充
那就真是


139
00:07:43,664 --> 00:07:44,865
在整个堆栈视图填充


140
00:07:44,932 --> 00:07:46,800
我还要做延伸
那么这就


141
00:07:46,867 --> 00:07:49,269
有点
间距有点太大


142
00:07:49,603 --> 00:07:54,374
比如说是20点
也许是25


143
00:07:57,044 --> 00:08:00,447
然后在标签和按钮
的堆栈视图


144
00:08:00,514 --> 00:08:03,283
加点间距
我来继续


145
00:08:03,350 --> 00:08:05,586
点击
改变间距


146
00:08:05,652 --> 00:08:08,188
我们再加上
大约5点


147
00:08:08,589 --> 00:08:12,793
我想在图标和头部
之间增加间距


148
00:08:13,093 --> 00:08:14,394
我可以继续


149
00:08:14,461 --> 00:08:16,730
选择使用文档大纲的
堆栈视图


150
00:08:17,431 --> 00:08:21,635
或者可以按下
键盘的Control-Shift


151
00:08:22,503 --> 00:08:25,772
点击图标
用鼠标点击


152
00:08:25,839 --> 00:08:26,740
所有视图


153
00:08:28,876 --> 00:08:31,044
我们点击
离我最近的堆栈视图


154
00:08:31,111 --> 00:08:36,049
水平方向的 
再调高25点


155
00:08:36,283 --> 00:08:37,751
我们继续 运行一下


156
00:08:42,054 --> 00:08:45,025
大家看 这就是我的布局
但我们还没有把它


157
00:08:45,092 --> 00:08:46,527
放在父视图里
我们会在这里


158
00:08:46,593 --> 00:08:48,028
运用
约束


159
00:08:48,996 --> 00:08:52,466
我来继续
将堆栈视图


160
00:08:52,533 --> 00:08:54,468
放在上端
用左对齐


161
00:08:55,135 --> 00:08:58,672
大家要注意
IB画布上的


162
00:08:59,973 --> 00:09:03,744
另一个按钮
可以打开Pin菜单


163
00:09:03,810 --> 00:09:05,479
以及弹出窗口


164
00:09:05,612 --> 00:09:08,448
以便加入左对齐
上端约束


165
00:09:08,749 --> 00:09:10,250
点击Add按钮时


166
00:09:11,618 --> 00:09:13,086
就会
加入约束


167
00:09:13,420 --> 00:09:16,290
现在 我们还想
加入底部和右对齐


168
00:09:16,690 --> 00:09:18,258
但是在
Interface Builder


169
00:09:18,325 --> 00:09:19,426
还有另一个
技巧可以使用


170
00:09:19,593 --> 00:09:21,495
可以在两个视图
中间拖拽


171
00:09:21,562 --> 00:09:23,230
我准备从堆栈视图
拖拽到


172
00:09:23,830 --> 00:09:26,667
父视图
并选中Trailing Space


173
00:09:26,733 --> 00:09:27,868
到Container Margin


174
00:09:28,435 --> 00:09:29,636
这就会添加
约束


175
00:09:29,736 --> 00:09:33,307
熟悉菜单的朋友
可以看到


176
00:09:33,373 --> 00:09:35,108
这里有多了
另外几个功能


177
00:09:36,610 --> 00:09:39,847
我们会在底部
添加另外一个约束


178
00:09:40,480 --> 00:09:42,015
在底部的布局指南中
添加垂直间距


179
00:09:42,850 --> 00:09:44,718
现在双击
约束


180
00:09:45,819 --> 00:09:49,857
设置约束
使之紧靠边缘


181
00:09:52,059 --> 00:09:53,560
现在运行一下


182
00:09:55,329 --> 00:09:57,197
就可以看到和父视图吻合


183
00:09:57,264 --> 00:09:59,032
这里有点不对劲


184
00:09:59,333 --> 00:10:01,068iddle
来看一下
段控件


185
00:09:59,333 --> 00:10:01,068
来看一下
段控件


186
00:10:01,435 --> 00:10:02,469
有点太长


187
00:10:02,636 --> 00:10:03,504
是什么情况？


188
00:10:03,770 --> 00:10:06,773
实际上 如果做旋转
会有些压扁变形


189
00:10:08,609 --> 00:10:13,113
上端的堆栈视图中
是在看子视图的方向


190
00:10:13,180 --> 00:10:14,848
所有这些都有着
同样的优先级


191
00:10:15,115 --> 00:10:17,050
同样的内容吸附性
优先级


192
00:10:17,117 --> 00:10:19,152
以及内容
压缩阻力优先级


193
00:10:19,686 --> 00:10:22,556
稍后 我们会
详细介绍这方面内容


194
00:10:22,623 --> 00:10:24,992
不过现在大家需要了解
要告知


195
00:10:25,058 --> 00:10:26,660
Stack View
哪一个会赢


196
00:10:26,960 --> 00:10:30,330
我只需选择
段控件


197
00:10:30,964 --> 00:10:34,101
进入大小检测器
选择优先级部分


198
00:10:35,202 --> 00:10:37,771
继续 调整吸附性
优先级


199
00:10:38,071 --> 00:10:40,307
因为我希望 段控件
吸附性更大些


200
00:10:41,542 --> 00:10:44,344
把250改成260


201
00:10:44,711 --> 00:10:46,813
只需要比默认值
调高一点即可


202
00:10:48,248 --> 00:10:52,586
与之相似 我想
调整压缩阻力 不要出杂音


203
00:10:52,853 --> 00:10:58,058
我来继续提高
垂直内容压缩阻力


204
00:10:58,125 --> 00:11:00,761ddle
从750改到760


205
00:10:58,125 --> 00:11:00,761
从750改到760


206
00:11:01,328 --> 00:11:02,696
现在运行一下


207
00:11:04,131 --> 00:11:05,666
看起来好多了


208
00:11:07,801 --> 00:11:08,936
要记住 谢谢


209
00:11:09,002 --> 00:11:10,337
谢谢


210
00:11:14,141 --> 00:11:15,709
还记得最开始的问题么？


211
00:11:16,610 --> 00:11:18,445
老板想让我们
加上新的控件


212
00:11:19,379 --> 00:11:21,148
这里就是具体做法


213
00:11:21,215 --> 00:11:24,852
告诉老板 没问题
可以搞定


214
00:11:25,185 --> 00:11:28,222
然后回到桌旁
打开故事板


215
00:11:29,756 --> 00:11:30,724
搜索控件


216
00:11:30,791 --> 00:11:32,125
本例中 我们
会用按钮...


217
00:11:32,459 --> 00:11:34,294
从图像库里
把它拖拽出来


218
00:11:34,795 --> 00:11:38,065
再找到准备
放入的堆栈视图放进去


219
00:11:39,032 --> 00:11:40,300
然后去找杯咖啡


220
00:11:49,142 --> 00:11:52,613
我还想指出一点
Stack View处理


221
00:11:52,679 --> 00:11:54,181
子视图的Hidden效果极好


222
00:11:55,015 --> 00:11:56,183
可以在程序里设置或通过


223
00:11:56,250 --> 00:11:58,051
Interface Builder
设置


224
00:11:58,118 --> 00:12:02,322
看似是崩溃
或是取自视图层


225
00:12:02,389 --> 00:12:03,991
但它仍属于
Stack View


226
00:12:04,591 --> 00:12:08,462
如果我标出Hidden 大家看
一切都会因此做调整


227
00:12:08,729 --> 00:12:10,430
我们觉得 大家
会认为这些是有用的内容


228
00:12:14,801 --> 00:12:17,171
这是Stack View的演示


229
00:12:23,310 --> 00:12:25,879
我还要说明
动画效果也非常容易


230
00:12:26,980 --> 00:12:28,048
大概是这样


231
00:12:29,550 --> 00:12:33,987
使用带有Duration块的
UIView Animate


232
00:12:34,054 --> 00:12:35,789
继续来调整 
子视图的Hidden属性


233
00:12:35,856 --> 00:12:36,957
我们会特殊处理这些


234
00:12:37,157 --> 00:12:39,826
或者可以把其他
可动画的属性加在这里


235
00:12:39,893 --> 00:12:41,962
进行调整 
包括堆栈视图


236
00:12:42,362 --> 00:12:43,864
本身的属性


237
00:12:44,198 --> 00:12:47,201
例如 调整坐标轴
这样是


238
00:12:47,267 --> 00:12:48,468
在水平和垂直之间


239
00:12:48,769 --> 00:12:50,003
你会看到
有些内容非常酷


240
00:12:56,276 --> 00:12:59,213
当然 在Cocoa中
是这样子的


241
00:12:59,279 --> 00:13:01,281
使用
NSAnimationContext


242
00:13:01,348 --> 00:13:02,482
运行动画组


243
00:13:05,252 --> 00:13:06,620
大家看到了什么？


244
00:13:06,920 --> 00:13:08,488
我们先来看
API


245
00:13:09,423 --> 00:13:11,625
很简单 都很熟悉
非常简单


246
00:13:12,226 --> 00:13:13,861
有坐标轴
或者是指定方向


247
00:13:13,994 --> 00:13:16,697
来描述堆栈
视图是水平还是垂直


248
00:13:17,231 --> 00:13:18,866
我们看到了
分布 对齐


249
00:13:19,233 --> 00:13:21,001
和间距属性


250
00:13:21,635 --> 00:13:23,437
接着就有办法
添加新的


251
00:13:23,504 --> 00:13:24,471
堆栈内容


252
00:13:24,638 --> 00:13:25,806
添加并安排子视图


253
00:13:25,873 --> 00:13:27,875
还可以插入
并删除


254
00:13:28,542 --> 00:13:31,011
希望大家注意
Arrange Subview属性


255
00:13:32,312 --> 00:13:37,918
这个属性可以恢复
属于堆栈视图的


256
00:13:38,852 --> 00:13:40,254
所有视图
的子集


257
00:13:40,621 --> 00:13:43,290
可以恢复目前堆栈
的视图


258
00:13:44,892 --> 00:13:47,694
意思是说
可以实现没有被


259
00:13:47,761 --> 00:13:50,397
Stack View
堆栈的视图 


260
00:13:50,464 --> 00:13:52,699
例如装饰器或叠加层
并实现洁净的视图层次


261
00:13:52,766 --> 00:13:54,568
我们觉得 大家
会认为这些是有用的内容


262
00:13:55,569 --> 00:14:00,007
在这些情况下大家只需要调用Add
Subview即可


263
00:14:01,375 --> 00:14:02,509
在这里我们看到什么？


264
00:14:03,243 --> 00:14:06,813
Stack View很容易设计
很容易维护


265
00:14:08,182 --> 00:14:10,851
相信大家会
构建很多这类东西


266
00:14:11,585 --> 00:14:14,321
因为Stack View
是关于布局


267
00:14:16,256 --> 00:14:20,027
因此不需要
修改自己的背景


268
00:14:20,294 --> 00:14:21,929
我们可以实现
部分优化


269
00:14:22,162 --> 00:14:24,865
因此我们有了特殊的
Transform Layer类


270
00:14:24,932 --> 00:14:28,101
不需要自我修改就可以让
Stack View运行更快


271
00:14:28,202 --> 00:14:30,170
比正常视图
更有表现力


272
00:14:30,704 --> 00:14:31,972
因此是轻量级的


273
00:14:38,812 --> 00:14:41,782
我们讨论过的示例
是有着许多约束的


274
00:14:42,449 --> 00:14:45,552
有着些许
维护难度


275
00:14:46,486 --> 00:14:48,288
从四个到若干堆栈视图都有涉及
这读起来要好得多


276
00:14:49,556 --> 00:14:52,826
我们觉得大家可以用
堆栈视图设计出


277
00:14:53,260 --> 00:14:56,330
大部分用户界面
所以建议从Stack View开始


278
00:14:56,830 --> 00:14:58,165
使用所需约束


279
00:14:58,599 --> 00:14:59,800
这就是Stack View


280
00:15:06,039 --> 00:15:09,877
有些情况下
不只要用到Stack View


281
00:15:10,844 --> 00:15:11,945
就需要...


282
00:15:12,012 --> 00:15:14,715
我想邀请朋友
卡西亚来聊聊


283
00:15:14,781 --> 00:15:16,483
布局引擎


284
00:15:22,322 --> 00:15:23,757
大家好
我是卡西亚


285
00:15:23,824 --> 00:15:26,693
我在iOS Keyboards
Team就职 我来这里和大家


286
00:15:26,760 --> 00:15:28,896
聊聊适当的处理
和提供布局引擎


287
00:15:28,962 --> 00:15:31,965
它有些任性
只希望是由你来完成


288
00:15:32,032 --> 00:15:34,268
如果大家处理正确
它就可以正确完成任务


289
00:15:34,968 --> 00:15:37,237
正如大家
在本周中所见


290
00:15:37,304 --> 00:15:39,806
我们有新的自适配环境
以及所有


291
00:15:39,873 --> 00:15:43,043
不同屏幕
大小的iPhone


292
00:15:43,110 --> 00:15:46,213
关键的一点在于
在所有这些环境下


293
00:15:46,280 --> 00:15:47,848
对布局属性进行规划


294
00:15:47,915 --> 00:15:50,951
而不是花费太多时间
在每个屏幕上


295
00:15:51,018 --> 00:15:51,952
进行重复


296
00:15:52,386 --> 00:15:53,954
大多数人 
一想到约束


297
00:15:54,021 --> 00:15:55,455
都是这么认为


298
00:15:55,756 --> 00:15:58,091
你生成部分视图
用不同方式


299
00:15:58,158 --> 00:16:01,461
创建部分约束
相当于是把它们扔进黑洞


300
00:16:01,995 --> 00:16:02,829
会出现问题


301
00:16:03,497 --> 00:16:04,831
在布局会弹出
另一端


302
00:16:05,199 --> 00:16:07,568
希望是你的 也可能不是


303
00:16:07,634 --> 00:16:11,572
今天我真正想做的是
试着解开


304
00:16:11,638 --> 00:16:13,807
部分谜团


305
00:16:13,874 --> 00:16:16,109
那么每次都会
碰到布局


306
00:16:16,176 --> 00:16:18,478
首先 我们来谈谈
改变约束


307
00:16:19,746 --> 00:16:22,082
我谈到改变约束时
主要是在谈论


308
00:16:22,149 --> 00:16:24,318
激活和关闭
约束


309
00:16:24,918 --> 00:16:26,720
以前用过
Auto Layout的朋友


310
00:16:26,787 --> 00:16:29,389
以及也许还记得
我们起初的


311
00:16:29,456 --> 00:16:31,925
对视图增加和删除
给出的约束的概念


312
00:16:32,359 --> 00:16:33,627
不要再这么做了


313
00:16:33,727 --> 00:16:35,696
激活和关闭
更好些


314
00:16:35,762 --> 00:16:38,799
这是二者NSLayout
约束的类方法


315
00:16:39,366 --> 00:16:42,636
使用
激活和关闭 


316
00:16:42,703 --> 00:16:44,037
有一些
真正的好处


317
00:16:44,371 --> 00:16:45,873
约束发现
自己的容器


318
00:16:45,939 --> 00:16:47,140
这样更有效率


319
00:16:47,641 --> 00:16:49,109
你不必拥有
自己布局中的


320
00:16:49,176 --> 00:16:50,577
所有视图
才能以便使用


321
00:16:51,311 --> 00:16:53,914
这其实可以总结成
不要再使用


322
00:16:53,981 --> 00:16:55,082
添加和删除


323
00:16:55,549 --> 00:16:56,884
要用激活和关闭


324
00:16:57,584 --> 00:17:00,654ddle
考虑改变约束时
还需要


325
00:16:57,584 --> 00:17:00,654
考虑改变约束时
还需要


326
00:17:01,021 --> 00:17:03,357
注意
几个问题


327
00:17:04,424 --> 00:17:07,361
第一 永远不要关闭
self.view.constraints


328
00:17:07,426 --> 00:17:08,996
中的所有内容


329
00:17:09,195 --> 00:17:10,664
如果有谁真这么做了


330
00:17:10,731 --> 00:17:13,032
可能会遇到
一些奇怪的问题


331
00:17:13,634 --> 00:17:15,702
那个数组中的
并非所有的约束都属于你


332
00:17:16,569 --> 00:17:18,605
比如在视图中
用于自行设置的功能


333
00:17:18,972 --> 00:17:20,641
那就会出现
奇怪的问题


334
00:17:21,241 --> 00:17:22,342
所以不要这么做


335
00:17:22,843 --> 00:17:24,310
一会儿就会知道答案


336
00:17:25,078 --> 00:17:27,614
相反只需要
对需要稍后修改的约束


337
00:17:27,681 --> 00:17:30,484
进行参考
无论是在约束数组


338
00:17:30,551 --> 00:17:32,586
还是在
单独的约束中均是如此


339
00:17:32,686 --> 00:17:35,055
这样就按照自己想要的方式
管理内容了


340
00:17:35,155 --> 00:17:37,391
我们先来看
改变约束


341
00:17:44,031 --> 00:17:47,100
这里是个 iPad app
我在里面做了


342
00:17:47,167 --> 00:17:52,139
一组行星
都按照iPad设置好了


343
00:17:52,206 --> 00:17:54,074
还有iPhone模式


344
00:17:54,141 --> 00:17:55,976
多任务处理
应该没有问题


345
00:17:56,610 --> 00:17:59,012
只是我并没有当真
删除任何约束


346
00:17:59,613 --> 00:18:02,049
所以当我从漂亮的
垂直简约布局回到


347
00:18:02,115 --> 00:18:04,852
平常的布局时
之前所有


348
00:18:04,918 --> 00:18:06,553
漂亮的曲线
都会消失不见


349
00:18:07,321 --> 00:18:09,289
我可能
首先想做的是


350
00:18:09,356 --> 00:18:12,125
进行修正 


351
00:18:12,192 --> 00:18:15,963
删除父视图中的
所有约束


352
00:18:19,466 --> 00:18:20,934
当我这么做时
还需要重新


353
00:18:21,001 --> 00:18:22,936
激活任何
共享约束


354
00:18:26,440 --> 00:18:29,943
但是如果尝试这种方式
你将看到


355
00:18:30,110 --> 00:18:31,645
会出现各种
令人兴奋的事情


356
00:18:32,579 --> 00:18:34,314
这里又是我的正常布局
非常好


357
00:18:34,915 --> 00:18:37,184
现在还是很好


358
00:18:38,852 --> 00:18:40,521
嗯 不太好了


359
00:18:41,121 --> 00:18:43,524
如果我返回
正常布局


360
00:18:43,590 --> 00:18:46,126
我其实不希望
这些行星有那么大


361
00:18:46,493 --> 00:18:47,928
这不是
我的本意


362
00:18:48,562 --> 00:18:49,897
怎么才能妥当处理呢？


363
00:18:49,963 --> 00:18:52,799
我准备花些时间
抓取这个代码 这样


364
00:18:52,866 --> 00:18:55,702
就不必看我把全文再打一遍了出来了


365
00:18:56,103 --> 00:18:58,071
那么在特性集合中
已经改变了 只需要


366
00:18:58,138 --> 00:19:02,543
查看每个环境下
你需要改变的


367
00:19:02,609 --> 00:19:04,711
另一组约束
是否激活


368
00:19:05,012 --> 00:19:07,147
我现在有两个数组
各有8个约束


369
00:19:07,481 --> 00:19:10,584
以区分行星的
垂直


370
00:19:10,918 --> 00:19:12,719
对齐状况


371
00:19:12,953 --> 00:19:14,721
如果我查看
确认是激活状态


372
00:19:14,988 --> 00:19:17,524
删除或关闭
我不再需要的内容


373
00:19:17,591 --> 00:19:21,061
再激活新的部分
现在看上去好多了


374
00:19:23,530 --> 00:19:24,998
正常


375
00:19:28,368 --> 00:19:29,736
还是正常


376
00:19:30,637 --> 00:19:33,707
简约再回到正常


377
00:19:34,141 --> 00:19:35,542
这就是我
实际要的结果


378
00:19:39,046 --> 00:19:40,047
哦 谢谢大家


379
00:19:40,547 --> 00:19:42,482
Auto Layout 
很酷的一点是


380
00:19:42,549 --> 00:19:44,852
你还可以将
约束改变做动画处理


381
00:19:45,352 --> 00:19:49,389
这里有个双击手势
可在正常和简约布局间


382
00:19:49,456 --> 00:19:53,093
进行动画处理
如果父视图需要的话 


383
00:19:53,160 --> 00:19:56,663
只要在调用布局时
拖拽激活和关闭 


384
00:19:56,730 --> 00:19:58,565
进入动画块即可


385
00:19:59,066 --> 00:20:02,769
大家会看到 如果我双击
就可以在这组视图和


386
00:20:03,003 --> 00:20:05,839
两行代码之间
轻松移动


387
00:20:06,373 --> 00:20:09,877
如果想来点花样
可以参照所有


388
00:20:09,943 --> 00:20:12,980
这些单独的约束
使用关键帧动画


389
00:20:13,647 --> 00:20:16,850
给app中的内容
加点料


390
00:20:17,951 --> 00:20:19,486
这就是


391
00:20:19,553 --> 00:20:21,455
适当激活
和关闭约束


392
00:20:21,588 --> 00:20:24,791
我们对改变约束
了解了哪些内容？


393
00:20:25,325 --> 00:20:26,226
对 第一点


394
00:20:26,293 --> 00:20:28,896
不要关闭
self.view.constraints


395
00:20:28,962 --> 00:20:30,030
对此我们非常清楚了


396
00:20:30,430 --> 00:20:31,965
参考约束
将在将来


397
00:20:32,032 --> 00:20:33,100
带来影响


398
00:20:33,467 --> 00:20:35,369
会让所有内容
都运行地更好


399
00:20:35,435 --> 00:20:36,870
可以实现很酷的效果
比如动画


400
00:20:37,337 --> 00:20:39,673
大家也可以将
改变约束做动画处理


401
00:20:40,040 --> 00:20:42,176
只要拖拽入
View Animation块即可


402
00:20:42,543 --> 00:20:43,710
相当非常酷


403
00:20:43,777 --> 00:20:45,546
我们现在还处于
设计布局的


404
00:20:45,612 --> 00:20:47,514
基础部分
我们仍然还有视图


405
00:20:47,581 --> 00:20:49,550
和约束并把他们
放入布局引擎


406
00:20:50,117 --> 00:20:52,319
但是如果要为
布局引擎提供更多信息


407
00:20:52,386 --> 00:20:56,223
在所有这些
自适配环境下


408
00:20:56,290 --> 00:20:58,125
我们可以获得很多
更好的结果


409
00:20:59,359 --> 00:21:02,296le
我们已经把所有
约束都安排好


410
00:20:59,359 --> 00:21:02,296
我们已经把所有
约束都安排好


411
00:21:02,362 --> 00:21:03,864
现在我想讲一讲
大小尺寸


412
00:21:04,898 --> 00:21:06,934
那么谜题三
就是视图大小


413
00:21:08,335 --> 00:21:10,037
有两种不同方法
来规定视图大小


414
00:21:10,237 --> 00:21:11,605
这显而易见


415
00:21:11,672 --> 00:21:14,741
我希望视图宽200点
高300点


416
00:21:15,309 --> 00:21:17,344
相反 还可以有 
不同方式


417
00:21:17,411 --> 00:21:21,281
生成约束
以便和我们现在


418
00:21:21,381 --> 00:21:23,884
所有不同的
环境相匹配


419
00:21:23,951 --> 00:21:26,720
我们先从
其中的内部内容尺寸开始


420
00:21:27,354 --> 00:21:29,656
许多视图都有这个
如标签和图像视图


421
00:21:30,190 --> 00:21:32,559
基本上就是
具备内容后视图


422
00:21:32,626 --> 00:21:34,761
应该具备的
尺寸大小


423
00:21:35,696 --> 00:21:38,665
引擎看着它
试图解决这个


424
00:21:39,199 --> 00:21:43,403
尺寸的布局问题
就会生成


425
00:21:43,470 --> 00:21:45,072
内部尺寸约束


426
00:21:45,806 --> 00:21:48,876
不过 它无法确保
布局大小 因为自适配


427
00:21:48,942 --> 00:21:51,378
这类问题所致
它需要少许


428
00:21:51,445 --> 00:21:52,779
伸缩视图


429
00:21:52,913 --> 00:21:55,549
用户不希望出现
这类情况


430
00:21:55,616 --> 00:21:56,950
但你可能会
在这里那里有几个


431
00:21:57,017 --> 00:21:58,118
多余的空隙点


432
00:21:58,919 --> 00:22:02,055le
可以用这个来
展示你的视图


433
00:21:58,919 --> 00:22:02,055
可以用这个来
展示你的视图


434
00:22:02,122 --> 00:22:04,024
表明你不一定
确定标签


435
00:22:04,091 --> 00:22:06,126
要这么宽才行


436
00:22:06,193 --> 00:22:07,961
就是和内容
一样宽


437
00:22:09,263 --> 00:22:11,131
但是如果需要定义
特定的视图尺寸


438
00:22:11,965 --> 00:22:13,200
那就从约束开始


439
00:22:13,901 --> 00:22:15,702
这样做
非常容易


440
00:22:16,069 --> 00:22:18,172
视图应该是
我的父视图的宽度一半


441
00:22:18,672 --> 00:22:19,806
这里应该是
我的父视图的


442
00:22:19,873 --> 00:22:20,774
的高度的四分之三


443
00:22:21,141 --> 00:22:22,743
这个应该是
和旁边的视图等大


444
00:22:23,810 --> 00:22:26,480
但是如果绝对需要的话
还可以覆盖


445
00:22:26,547 --> 00:22:27,714
内部内容尺寸


446
00:22:28,048 --> 00:22:30,284
这样做 只能
是出于两个原因


447
00:22:30,784 --> 00:22:33,020
其一是你无法
从约束那里


448
00:22:33,086 --> 00:22:34,087
获得尺寸信息


449
00:22:35,022 --> 00:22:38,192
其二可能是如果你在
视图中使用了自定义绘图


450
00:22:38,258 --> 00:22:40,394
但在很多情况下
你还可以设置


451
00:22:40,794 --> 00:22:43,363
这个视图的约束
而不必去做任何


452
00:22:43,430 --> 00:22:45,399
需要覆盖内部
内容尺寸的事情


453
00:22:45,933 --> 00:22:47,868
如果确实覆盖了
内部内容尺寸


454
00:22:47,935 --> 00:22:50,170
你还要负责
在出现滑动类改变


455
00:22:50,470 --> 00:22:53,173
或文本改变的时候
使之失效


456
00:22:53,240 --> 00:22:55,609
这样你需要获得
动态文本 本地化


457
00:22:55,676 --> 00:22:59,546
或任何这类需要
导致视图


458
00:22:59,613 --> 00:23:01,315dle
需要重新计算
内部尺寸的内容


459
00:22:59,613 --> 00:23:01,315
需要重新计算
内部尺寸的内容


460
00:23:02,149 --> 00:23:05,352
我们现在来看
用约束设置视图


461
00:23:05,419 --> 00:23:07,421
而不使用任何
特殊点的尺寸


462
00:23:07,487 --> 00:23:08,856
都是在关系当中


463
00:23:09,022 --> 00:23:10,457
这里是个
标准图像视图


464
00:23:11,024 --> 00:23:13,126
我希望在这是
视图的主要部分


465
00:23:13,760 --> 00:23:16,797
因此我想让宽度
等于它所在


466
00:23:16,864 --> 00:23:18,565
视图的四分之三


467
00:23:18,632 --> 00:23:20,534
这意味着在它
所在的每个环境


468
00:23:20,767 --> 00:23:22,402
宽度都是
该视图的四分之三


469
00:23:22,703 --> 00:23:23,971
先来设置


470
00:23:25,072 --> 00:23:27,975
然后获得这一比例
我是从


471
00:23:28,075 --> 00:23:31,311
父视图计算
再乘以1.5


472
00:23:31,378 --> 00:23:33,046
来得到
高度值


473
00:23:33,647 --> 00:23:35,282
这样在多任务处理时
可以在所有设备


474
00:23:35,349 --> 00:23:38,385
和所有模式下
获得一致的布局


475
00:23:39,486 --> 00:23:43,390
因此视图尺寸
很重要 对比例


476
00:23:43,457 --> 00:23:45,859
依赖性越高 
获得优质布局的可能性越大


477
00:23:45,926 --> 00:23:48,362
这将非常便于你
在所有这些


478
00:23:48,428 --> 00:23:50,330
我们提供的不同
屏幕上放置内容


479
00:23:50,764 --> 00:23:52,900
很多人在考虑
尺寸视图时


480
00:23:52,966 --> 00:23:55,636
都会考虑到一个问题
就是自适应调整视图


481
00:23:56,203 --> 00:23:58,772
特别是自适应
调整表视图单元格


482
00:23:59,640 --> 00:24:02,743le
这些单元格从
其内容中获得高度


483
00:23:59,640 --> 00:24:02,743
这些单元格从
其内容中获得高度


484
00:24:03,243 --> 00:24:05,646
所以不必在表视图中
从上到下


485
00:24:05,712 --> 00:24:06,780
都是一个单元格大小


486
00:24:06,847 --> 00:24:08,549
可以根据
其中的内容


487
00:24:08,615 --> 00:24:09,716
确定不同的大小


488
00:24:10,284 --> 00:24:11,518
实际上不必


489
00:24:11,585 --> 00:24:13,820
自己计算
每行的高度


490
00:24:14,221 --> 00:24:15,489
约束可以帮助
完成这些工作


491
00:24:15,689 --> 00:24:19,426
所以自适应调整


492
00:24:20,194 --> 00:24:21,995
需要从约束中获得大小尺寸


493
00:24:22,429 --> 00:24:24,064
这里也不是以点来计


494
00:24:24,131 --> 00:24:25,933
而是按照比例
是依赖例如


495
00:24:25,999 --> 00:24:28,068
内部内容尺寸这类东西
帮你完成


496
00:24:28,368 --> 00:24:32,172
表视图单元格
已经定义好宽度


497
00:24:32,239 --> 00:24:33,373
所以只需要考虑高度


498
00:24:33,841 --> 00:24:35,809
可以利用比例
来完成


499
00:24:36,343 --> 00:24:37,678
这里是个表视图单元格


500
00:24:38,011 --> 00:24:40,781
标签应该是
图像视图的两倍宽


501
00:24:41,481 --> 00:24:43,717
中间有一点
空隙


502
00:24:44,985 --> 00:24:48,488
因此当我的标签因为
文本内容多更高些时


503
00:24:49,289 --> 00:24:52,259
表视图单元格会
相应增加与之适应


504
00:24:53,193 --> 00:24:55,696
我们现在来看个
短的演示了解是怎么回事


505
00:25:02,369 --> 00:25:04,872
好这里是表视图单元格
我已经


506
00:25:04,938 --> 00:25:06,540
设置了
水平方向束缚


507
00:25:07,140 --> 00:25:09,243
那么如果就这样
设计和运行


508
00:25:09,309 --> 00:25:12,145
结果不会完全
符合我的预期


509
00:25:13,747 --> 00:25:15,616
所有内容都会
有些变形


510
00:25:15,682 --> 00:25:17,751
预计的表视图
高度为60


511
00:25:17,818 --> 00:25:19,520
所以默认
画在这里


512
00:25:19,920 --> 00:25:22,956
我想做的是
告诉表视图单元格


513
00:25:23,323 --> 00:25:28,195
如果标签内容增加
它也要随之改变


514
00:25:28,262 --> 00:25:33,600
我通过把顶锚和底锚
放在一起来实现


515
00:25:34,001 --> 00:25:36,470
那么标签就会继续
拉动表视图


516
00:25:36,537 --> 00:25:38,305
单元格的尺寸
使其更高


517
00:25:38,872 --> 00:25:42,843
顶边距 底边距
到容器边缘


518
00:25:43,177 --> 00:25:44,378
来看看效果怎样


519
00:25:47,247 --> 00:25:48,582
好多了


520
00:25:49,116 --> 00:25:50,617
但还是和我
想要的不太一样


521
00:25:50,751 --> 00:25:53,086
因为我们是
这样的单元格


522
00:25:53,420 --> 00:25:55,055
而在图像中切掉了


523
00:25:55,122 --> 00:25:56,590
一部分 因为标签
不够高


524
00:25:57,124 --> 00:25:59,793
为解决这个问题
我们可以利用


525
00:25:59,893 --> 00:26:02,329
视图可以延伸至
内部内容尺寸以外的特性


526
00:26:02,396 --> 00:26:05,832
告诉标签
它应该至少


527
00:26:05,899 --> 00:26:08,435
和图像一样高才行


528
00:26:09,336 --> 00:26:11,705
所以标签会
在周围多一些间隙


529
00:26:11,772 --> 00:26:17,344
可以允许
从图像的高度开始


530
00:26:17,578 --> 00:26:19,146
再有所延伸
至合适高度为止


531
00:26:19,213 --> 00:26:20,914
大家看不到
额外的间距


532
00:26:20,981 --> 00:26:22,316
文本位置很好
都是居中


533
00:26:22,783 --> 00:26:25,052
但是标签仍在
定义表视图


534
00:26:25,118 --> 00:26:27,387
单元格的高度


535
00:26:28,288 --> 00:26:29,623
现在看起来好多了


536
00:26:29,790 --> 00:26:31,792
我所有的单元格
大小都合适


537
00:26:32,326 --> 00:26:34,127
我可以看到
想看的所有内容


538
00:26:34,194 --> 00:26:36,530
在创建自适应
调整的表视图单元格时


539
00:26:36,597 --> 00:26:38,432
需要做的就是
这些


540
00:26:39,132 --> 00:26:41,468
只要确认所有内容
都完全定义即可


541
00:26:47,040 --> 00:26:49,443
谢谢好
那么关于视图大小


542
00:26:49,510 --> 00:26:50,644
我们讲了些什么呢？


543
00:26:50,711 --> 00:26:52,079
部分视图具备
内部内容尺寸


544
00:26:52,145 --> 00:26:54,147
利用这个属性
来定义其他


545
00:26:54,214 --> 00:26:55,382
视图的关系


546
00:26:55,449 --> 00:26:57,818
可能的话 约束应该
定义大小


547
00:26:58,218 --> 00:27:00,654
如果不能 则要覆盖
内部内容尺寸


548
00:27:01,021 --> 00:27:03,590
但是要确保这么做时
将内部内容尺寸设为无效


549
00:27:03,891 --> 00:27:05,626
对于自适应调整
视图 需要


550
00:27:05,692 --> 00:27:07,361
完全在约束中
定义尺寸


551
00:27:08,495 --> 00:27:09,730
在哪里设计
布局呢？


552
00:27:09,930 --> 00:27:11,365
我们有
原始信息


553
00:27:12,165 --> 00:27:14,001
我们会加上
部分尺寸约束


554
00:27:14,768 --> 00:27:16,537
从我们放在
一起的视图


555
00:27:16,603 --> 00:27:18,005
得出内部内容尺寸


556
00:27:18,205 --> 00:27:19,506
接下来是什么？


557
00:27:19,573 --> 00:27:22,476
怎样帮助布局
引擎了解我们需要什么？


558
00:27:22,910 --> 00:27:24,144
我们要给出一些优先级


559
00:27:24,878 --> 00:27:27,514
这就是谜题5


560
00:27:27,948 --> 00:27:30,083
如果接触
Auto Layout已有一段时间


561
00:27:30,150 --> 00:27:31,451
可能会遇到过
这样的情况


562
00:27:31,518 --> 00:27:33,987
即视图没有
按照父视图所设置


563
00:27:34,054 --> 00:27:35,756
位于相应位置


564
00:27:36,223 --> 00:27:38,825
也许在每次设计和运行中
都会有所不同


565
00:27:39,126 --> 00:27:41,828
或是在旋转或
修改尺寸后 都会有所不同


566
00:27:42,296 --> 00:27:43,830
这就是歧义


567
00:27:44,464 --> 00:27:46,166
出现这种情况
可能是由于两种不同原因


568
00:27:46,733 --> 00:27:48,435
一是在你需要
的方向中


569
00:27:48,502 --> 00:27:50,070
并没有
足够的约束


570
00:27:50,671 --> 00:27:54,641
例如 我想把Saturn
放在中间的位置


571
00:27:54,708 --> 00:27:57,778
就是这些虚线上
但是当我运行


572
00:27:57,845 --> 00:28:00,747e
app时 它却跑到
左边或右边


573
00:27:57,845 --> 00:28:00,747
app时 它却跑到
左边或右边


574
00:28:01,281 --> 00:28:02,783
这也许是说明
我没有足够的


575
00:28:02,850 --> 00:28:05,519
水平约束告知
引擎该把Saturn放在哪儿


576
00:28:05,686 --> 00:28:07,487
垂直方向 看似还好
那不错


577
00:28:07,921 --> 00:28:10,791
还有一个因素
可能导致如此是


578
00:28:10,858 --> 00:28:12,059
这是等值不需要的优先级


579
00:28:12,492 --> 00:28:15,462
等值所需的优先级
会调用不合格的约束


580
00:28:15,896 --> 00:28:17,731
如果布局引擎不能如此
解决视图问题的话


581
00:28:18,098 --> 00:28:21,201
等值不需要的优先级
是指引擎


582
00:28:21,268 --> 00:28:22,603
已经为替你做了选择


583
00:28:23,437 --> 00:28:26,006
它已经尽力
做出好的选择


584
00:28:26,640 --> 00:28:28,442
但是它确实不知道
你想要什么


585
00:28:28,642 --> 00:28:31,445
所以需要提供
更多的内容来实现目的


586
00:28:32,646 --> 00:28:33,981
优先级怎么起作用呢?


587
00:28:34,648 --> 00:28:37,618
区间是从1到1000
我们还有几个常数


588
00:28:37,684 --> 00:28:40,254
帮助平衡
优先级


589
00:28:40,387 --> 00:28:42,990
布局优先级
需要的是1000


590
00:28:43,657 --> 00:28:46,393
默认高度为750
默认低点是250


591
00:28:47,060 --> 00:28:49,463
在可视化格式语言中
是这样的效果


592
00:28:49,530 --> 00:28:52,866
只需要在希望使用的
数字前加上@符号即可


593
00:28:52,999 --> 00:28:54,501
在Interface Builder中
可以直接


594
00:28:54,568 --> 00:28:55,969
把它固定在文本域中


595
00:28:56,737 --> 00:28:59,439e
如果使用显性约束
这就是属性


596
00:29:00,073 --> 00:29:01,875
你可以实际上
运用这些常数


597
00:29:02,142 --> 00:29:04,111
或数字或是
二者组合


598
00:29:04,811 --> 00:29:07,714
进行比较时
优先级最高的会胜出


599
00:29:08,582 --> 00:29:11,585
我们先来看看
在内容优先级


600
00:29:11,652 --> 00:29:13,153
上下文中
的情况


601
00:29:13,754 --> 00:29:15,155
但是必须注意的是


602
00:29:15,222 --> 00:29:18,892
这个系统有着
安排内部视图的部分属性


603
00:29:19,393 --> 00:29:22,796
在iOS中 我们的系统
布局尺寸符合50的大小


604
00:29:23,063 --> 00:29:26,166
有若干窗口
优先级在500左右


605
00:29:26,233 --> 00:29:30,437
490 500和510
OS X会用到


606
00:29:30,637 --> 00:29:32,673
如果来看
NSLayoutConstraint头部


607
00:29:32,739 --> 00:29:34,041
你会看到
这些数字具体是多少


608
00:29:34,107 --> 00:29:35,776
如果把这些
数字设置为等值


609
00:29:35,843 --> 00:29:37,511
最后会出现
歧义的情况


610
00:29:37,578 --> 00:29:38,679
大家可能会遇到


611
00:29:38,745 --> 00:29:40,881
你想要使用比
系统采用的


612
00:29:40,948 --> 00:29:42,716
优先级稍高
或稍低的值


613
00:29:43,483 --> 00:29:44,818
内容优先级


614
00:29:45,519 --> 00:29:47,287
这些就是视图
处理内容的方法


615
00:29:47,955 --> 00:29:50,123
默认状态都是
设置为Not Required


616
00:29:50,824 --> 00:29:52,326
你不应该
设置为Required


617
00:29:53,093 --> 00:29:54,761
内容需要
能移动一点


618
00:29:54,962 --> 00:29:55,896
我们有动态文本


619
00:29:55,963 --> 00:29:56,864
有本地化


620
00:29:56,930 --> 00:30:00,167
可能还要让用户
可以选择不同的图像 像这样


621
00:30:00,501 --> 00:30:02,436
还需要具备
一点自由调整的空间


622
00:30:02,503 --> 00:30:04,238
不能说一直都是
这样的大小


623
00:30:04,471 --> 00:30:06,707
最后都会是
不合乎要求的约束


624
00:30:07,407 --> 00:30:10,210
但是未经修正
的相同优先级


625
00:30:10,277 --> 00:30:11,778
会导致歧义 我刚说过


626
00:30:12,179 --> 00:30:14,948
我们来看看
使用内容吸附性


627
00:30:15,015 --> 00:30:16,583
优先级的实例
这是我们所拥有的


628
00:30:16,650 --> 00:30:18,018
两种内容
优先级之一


629
00:30:18,852 --> 00:30:20,721
这里是
文本域和按钮


630
00:30:21,688 --> 00:30:23,557
文本域都
偏到了这边


631
00:30:23,624 --> 00:30:24,925
按钮都
分散开了


632
00:30:24,992 --> 00:30:28,128
这是因为
它们的默认内容


633
00:30:28,195 --> 00:30:30,430
吸附性优先级都是250


634
00:30:31,064 --> 00:30:32,566
引擎需要
做出选择


635
00:30:32,633 --> 00:30:35,435
它不清楚
答案是这个还是这个


636
00:30:36,436 --> 00:30:39,940
你实际上可以告诉它
每次应该选择哪个答案


637
00:30:40,007 --> 00:30:43,143
而不是根据情况
选择这个或那个


638
00:30:43,410 --> 00:30:47,147
如果把按钮的
内容吸附性优先级


639
00:30:47,214 --> 00:30:49,850
下调到249
就会得到第一个布局


640
00:30:50,250 --> 00:30:53,854
这是因为引擎
看到约束


641
00:30:53,921 --> 00:30:55,355
和优先级
觉得 嗯


642
00:30:55,622 --> 00:30:57,891
文本视图吸附性
优先级相当重要


643
00:30:58,392 --> 00:31:00,594le
但是按钮吸附性优先级
没那么重要


644
00:30:58,392 --> 00:31:00,594
但是按钮吸附性优先级
没那么重要


645
00:31:00,928 --> 00:31:02,963
我可以继续
从内容中伸出一块


646
00:31:03,330 --> 00:31:06,466
填充视图的
水平部分


647
00:31:07,467 --> 00:31:08,669
同时 如果
用到按钮


648
00:31:08,735 --> 00:31:11,171
并把内容吸附性
优先级置于


649
00:31:11,238 --> 00:31:13,440
文本域之上
就会得到另一种解决方案


650
00:31:13,740 --> 00:31:15,042
因为引擎会觉得


651
00:31:15,108 --> 00:31:17,311
现在我要紧密
吸附按钮文本


652
00:31:17,377 --> 00:31:19,379
这就意味着
我可以伸长文本域


653
00:31:19,680 --> 00:31:21,114
以便解决布局问题


654
00:31:21,715 --> 00:31:23,116
在调整这类
发生歧义的情况时


655
00:31:23,183 --> 00:31:26,386
所需要做的
就是这些


656
00:31:26,587 --> 00:31:28,956
还有一类
内容优先级


657
00:31:29,022 --> 00:31:30,257
是压缩阻力


658
00:31:30,824 --> 00:31:35,329
这是视图多大程度上
可以阻止内容的压扁


659
00:31:35,896 --> 00:31:39,266
顺便说一下 压扁在这里
是个技术术语


660
00:31:39,333 --> 00:31:41,568
需要给人留下深刻印象时
可以随便使用


661
00:31:42,302 --> 00:31:47,040
图像视图的压缩阻力
和水平方向的


662
00:31:47,107 --> 00:31:49,142
标签默认
为750


663
00:31:49,209 --> 00:31:51,778
这个优先级相当高
因为平时


664
00:31:51,845 --> 00:31:53,113
你希望看到所有内容


665
00:31:53,780 --> 00:31:55,649
但是如果要本地化
这个app该怎么办？


666
00:31:56,216 --> 00:31:58,285
如果有了这两个
彼此竞争的因素


667
00:31:58,552 --> 00:32:00,554e
而所用的语言中
“红色”这个词


668
00:31:58,552 --> 00:32:00,554
而所用的语言中
“红色”这个词


669
00:32:00,621 --> 00:32:01,555
非常长 比如波兰语


670
00:32:02,189 --> 00:32:03,223
则可能会被剪裁


671
00:32:03,290 --> 00:32:05,359
这就是引擎
必须做出的决定之一


672
00:32:05,759 --> 00:32:08,195
它可能会收缩
图形视图或是剪裁标签


673
00:32:08,262 --> 00:32:10,464
它并不清楚
你真正要做什么


674
00:32:10,531 --> 00:32:11,698
所以它自行做决定


675
00:32:12,399 --> 00:32:14,468
如果希望标签
一直都能显示全部内容


676
00:32:14,535 --> 00:32:16,336
少许收缩图像
也可以


677
00:32:16,603 --> 00:32:20,474
你只需要把
标签内容压缩阻力


678
00:32:20,541 --> 00:32:22,209
优先级设置的
略高于


679
00:32:22,276 --> 00:32:25,679
图像视图即可
现在就可以看到整个视图


680
00:32:25,746 --> 00:32:28,916
在做本地化时
需要做这些调整


681
00:32:28,982 --> 00:32:31,451
以确保观众
可以看到全部


682
00:32:31,518 --> 00:32:32,553
文本内容


683
00:32:34,254 --> 00:32:36,089
这些就是优先级


684
00:32:37,591 --> 00:32:39,326
它们可以帮你
解决不满意度问题


685
00:32:40,227 --> 00:32:42,763
这会导致
你在设计和运行时 


686
00:32:42,930 --> 00:32:45,365
一切都出现问题 
日志会相当难看


687
00:32:45,599 --> 00:32:48,101
因此它们会很有用
但是需要注意


688
00:32:48,168 --> 00:32:49,236
竞争性优先级


689
00:32:49,603 --> 00:32:51,972
如果存在竞争性
就会出现歧义 如大家所见


690
00:32:52,573 --> 00:32:54,508
当你这么做时 结果是
各屏幕和窗口间的


691
00:32:54,575 --> 00:32:55,976
更多一致性


692
00:32:56,743 --> 00:32:58,879
如果优先级
用的很好


693
00:32:58,946 --> 00:33:00,013iddle
就可以得到正确的布局


694
00:32:58,946 --> 00:33:00,013
就可以得到正确的布局


695
00:33:00,380 --> 00:33:02,716
有时候 只需要
对吸附性


696
00:33:02,783 --> 00:33:04,551
或压缩阻力
稍作调整


697
00:33:05,185 --> 00:33:08,055
现在 在设计布局时
我们为约束和


698
00:33:08,155 --> 00:33:10,190
内容加上了
部分优先级


699
00:33:10,991 --> 00:33:14,194
为了解决这个布局问题
我们还需要什么？


700
00:33:14,795 --> 00:33:15,829
对齐安排


701
00:33:16,363 --> 00:33:17,931
那么 如果已经用过
Auto Layout 那你会对


702
00:33:17,998 --> 00:33:19,166
视图对齐安排很熟悉


703
00:33:19,233 --> 00:33:21,201
它们会需要某些
水平对齐


704
00:33:21,268 --> 00:33:23,470
这样就会知道如何
彼此关联


705
00:33:23,537 --> 00:33:24,738
还有垂直对齐 


706
00:33:25,239 --> 00:33:28,642
我这里会主要介绍
对齐文本


707
00:33:29,476 --> 00:33:33,447
首先 在文本视图中
我们有基线


708
00:33:33,514 --> 00:33:34,815
的概念
这就是在


709
00:33:34,882 --> 00:33:37,518
文本底部下方的线条


710
00:33:38,218 --> 00:33:40,554
文本视图有着第一条基线


711
00:33:40,621 --> 00:33:43,690
和最后一条基线的
对齐安排 


712
00:33:44,057 --> 00:33:47,728
第一条基线就在
第一行文本下方


713
00:33:47,961 --> 00:33:50,430
最后一条基线
则是在最后一行文本下方


714
00:33:50,964 --> 00:33:54,501
单行文本视图
这两个值彼此相等


715
00:33:54,968 --> 00:33:58,172
所以在很多情况下
文本对齐效果


716
00:33:58,238 --> 00:34:00,374
胜过顶部或底部
并对动态文本大小


717
00:34:00,440 --> 00:34:01,875
这类内容有帮助


718
00:34:02,342 --> 00:34:05,145
通过它 可以更好地控制
改变视图


719
00:34:05,379 --> 00:34:06,547
以及内容需要变化


720
00:34:06,613 --> 00:34:08,248
例如 如果在按钮旁
有个标签


721
00:34:08,315 --> 00:34:10,851
并且是底部对齐
在这种情况下


722
00:34:10,918 --> 00:34:12,585
按钮边缘
有些大


723
00:34:12,652 --> 00:34:14,087
因为是在
填充一些多余的间距


724
00:34:14,821 --> 00:34:18,058
如果我加上两行
文本 按钮就可能


725
00:34:18,125 --> 00:34:20,427
变得模糊不清


726
00:34:21,128 --> 00:34:23,197
我想变成居中对齐


727
00:34:23,263 --> 00:34:26,400
或是变成消息那样
放在底部


728
00:34:26,800 --> 00:34:28,435
靠近文本
最后一行


729
00:34:28,502 --> 00:34:30,070
效果则好些


730
00:34:30,137 --> 00:34:33,473
如果我是依照最后基线
对齐 无论


731
00:34:33,540 --> 00:34:36,443
文本视图做什么
按钮还将与


732
00:34:36,510 --> 00:34:37,777
最后的基线对齐


733
00:34:37,844 --> 00:34:39,580
当然也可以根据
第一条基线这么做


734
00:34:39,646 --> 00:34:41,815
如果你想要
的视图是这样


735
00:34:41,882 --> 00:34:44,784
如果视图在不断变化
它也在和周围的


736
00:34:44,851 --> 00:34:46,186
视图保持对齐状态


737
00:34:46,920 --> 00:34:51,425
文本对齐的另一个
重要内容是左对齐和右对齐


738
00:34:51,491 --> 00:34:53,460
这对所有类型视图
都很重要


739
00:34:53,860 --> 00:34:56,330
但是对本地化
用处相当大


740
00:34:56,763 --> 00:34:59,299
如果是在用
从左到右的语言


741
00:34:59,366 --> 00:35:01,335le
在编写app时
对布局运用


742
00:34:59,366 --> 00:35:01,335
在编写app时
对布局运用


743
00:35:01,401 --> 00:35:04,438
左右约束
语言本地化时


744
00:35:04,505 --> 00:35:06,306
用的是从右到左
这怎样结果


745
00:35:06,373 --> 00:35:07,941
就会很奇怪


746
00:35:08,075 --> 00:35:09,443
效果
就像是这样


747
00:35:10,110 --> 00:35:11,578
所有内容都
各自到位


748
00:35:12,346 --> 00:35:14,248
但是无法正常阅读


749
00:35:14,381 --> 00:35:16,383
我以前是通过
图像视图了解文本


750
00:35:16,450 --> 00:35:19,286
现在是从另一个方向
阅读文本


751
00:35:19,353 --> 00:35:20,654
而且是在
图像视图上面


752
00:35:20,721 --> 00:35:22,055
这不是我想要的


753
00:35:22,122 --> 00:35:25,425
如果你在左对齐和
右对齐用的是


754
00:35:25,492 --> 00:35:28,795
同样的约束
左边是左对齐和 


755
00:35:28,862 --> 00:35:31,532
右边是右对齐
那就会形成正确的布局


756
00:35:31,598 --> 00:35:34,968
切换到不同 
于最初的


757
00:35:35,035 --> 00:35:37,504
语言走向时
所有内容的读取


758
00:35:37,571 --> 00:35:39,840
都会按照你最初
设计的思路实现


759
00:35:40,440 --> 00:35:43,243
因此就常用左对齐
和右对齐好了


760
00:35:43,510 --> 00:35:45,345
也许会有
某些情况


761
00:35:45,412 --> 00:35:46,747
需要你使用
左和右


762
00:35:46,914 --> 00:35:48,448
现在我还
不知道熟悉有哪些情况


763
00:35:48,515 --> 00:35:49,783
大家肯定曾
遇到过这种情况


764
00:35:50,284 --> 00:35:52,619
但是如果需要用
左和右


765
00:35:52,953 --> 00:35:56,023
小心不要和
左对齐和右对齐混淆


766
00:35:56,089 --> 00:35:58,025
因为当环境
发生改变


767
00:35:58,091 --> 00:36:00,294ddle
最后可能会
导致令人不满的约束


768
00:35:58,091 --> 00:36:00,294
最后可能会
导致令人不满的约束


769
00:36:01,461 --> 00:36:02,596
好 关于对齐问题


770
00:36:02,663 --> 00:36:05,999
的最后内容是
对齐矩形


771
00:36:06,733 --> 00:36:08,435
对齐矩形很重要


772
00:36:08,502 --> 00:36:10,571
因为引擎就是
计算这些数值


773
00:36:11,104 --> 00:36:12,840
引擎会把所有
约束考虑在内


774
00:36:13,207 --> 00:36:15,576
计算对齐矩形
在根据这些


775
00:36:15,642 --> 00:36:17,110
实际安排视图


776
00:36:17,778 --> 00:36:20,480
那么对齐矩形是什么？


777
00:36:20,547 --> 00:36:23,250
通常就是视图的
框架 但也不总是如此


778
00:36:24,051 --> 00:36:26,320
它不仅是视图
周围的框架


779
00:36:26,386 --> 00:36:28,488
还包括视图的
关键性内容


780
00:36:28,922 --> 00:36:30,390
也就是你真正
需要对齐的内容


781
00:36:30,924 --> 00:36:32,359
例如 我们有个
复选框


782
00:36:32,426 --> 00:36:33,827
如果和其他视图一起
在做居中


783
00:36:33,894 --> 00:36:35,896
对齐
你可能需要


784
00:36:35,963 --> 00:36:38,298
根据圆心对齐
而不是在


785
00:36:38,365 --> 00:36:40,367
复选框中心对齐
整个勾选


786
00:36:40,434 --> 00:36:41,602
可能要
稍稍高一些


787
00:36:42,035 --> 00:36:43,971
带有阴影的按钮
也是如此


788
00:36:44,338 --> 00:36:46,306
需要去除那些
多余的点


789
00:36:46,373 --> 00:36:48,742
并关注内容的
主要部分


790
00:36:49,176 --> 00:36:51,512
当视图发生改变时
它也不会变化


791
00:36:51,912 --> 00:36:53,780
当你安排视图时
并想强调


792
00:36:53,847 --> 00:36:56,283
或取消强调某些内容
这不会影响


793
00:36:56,350 --> 00:36:58,218
布局的其他部分
导致出现变形


794
00:36:59.286 --> 00:37:00.888 align:middle
如果的确需要改变


795
00:36:59,286 --> 00:37:00,888
如果的确需要改变


796
00:37:01,121 --> 00:37:04,525
这种情况其实很少见
我们可以覆盖


797
00:37:04,658 --> 00:37:06,593
可用的对齐矩形
边界间距


798
00:37:06,994 --> 00:37:09,429
基本上这相当于
告知引擎


799
00:37:09,496 --> 00:37:11,598
不管你算出的对齐矩形
是什么


800
00:37:11,798 --> 00:37:13,901
边界间距是这样的
要用这个数值


801
00:37:13,967 --> 00:37:17,804
在布局中 这种情况
非常少见


802
00:37:17,871 --> 00:37:19,173
不过如果需要 可以用这个方法


803
00:37:19,840 --> 00:37:23,343
为了解引擎
实际的计算结果


804
00:37:23,510 --> 00:37:26,013
可以使用Xcode的Debug菜单
中的视图调试选项


805
00:37:26,079 --> 00:37:27,748
将之拖入视图


806
00:37:28,415 --> 00:37:31,118
再选定ShowAlignment
Rectangle即可


807
00:37:31,185 --> 00:37:33,420
这会将黄色对齐
矩形拖入视图


808
00:37:34,021 --> 00:37:36,924
还可以通过
具体视图的框架


809
00:37:36,990 --> 00:37:38,625
对齐矩形来实现


810
00:37:39,593 --> 00:37:41,461
在第二部分的 
调试布局部分


811
00:37:41,528 --> 00:37:44,498
我们会谈到更多详情
如果想要了解


812
00:37:44,565 --> 00:37:46,500
这些都是如何工作
一定要记得参加


813
00:37:47,835 --> 00:37:49,436
关于对齐 我们介绍了


814
00:37:49,503 --> 00:37:51,104
文本与其他内容
不大相同


815
00:37:51,171 --> 00:37:54,474
在准备app时 
大家想要确认可以


816
00:37:54,541 --> 00:37:56,844
做动态文本
和本地化


817
00:37:56,910 --> 00:37:58,779
Auto Layout 
可以助你一臂之力


818
00:37:59.313 --> 00:38:00.747 align:middle
如果需要将有趣的 


819
00:37:59,313 --> 00:38:00,747
如果需要将有趣的 


820
00:38:00,814 --> 00:38:02,382
具体视图安放在
具体框架中


821
00:38:02,449 --> 00:38:05,853
还可以借机
覆盖对齐矩形


822
00:38:05,919 --> 00:38:07,487
边界间距


823
00:38:08,255 --> 00:38:09,656
有关布局 我们讲到哪里了？


824
00:38:10,224 --> 00:38:13,894
好现在是对齐部分
如果有必要的话


825
00:38:13,961 --> 00:38:15,696
我们覆盖了两个
对齐矩形边界间距


826
00:38:16,864 --> 00:38:19,800
现在就让引擎来
完成工作


827
00:38:20,534 --> 00:38:21,668
把所有内容都
放在里面


828
00:38:22,769 --> 00:38:24,004
布局引擎
会进行思考


829
00:38:24,071 --> 00:38:29,276
计算对齐矩形
然后用来实际设计布局


830
00:38:30,143 --> 00:38:33,380
现在的布局
正如你所愿


831
00:38:33,714 --> 00:38:34,548
适合各种屏幕大小


832
00:38:34,615 --> 00:38:35,883
相信我 这就是
你想要的布局


833
00:38:38,051 --> 00:38:39,086
我们来看一下


834
00:38:39,152 --> 00:38:41,054
我们总结一下
今天所讲的内容


835
00:38:41,822 --> 00:38:44,691
堆栈视图是设计
可维护布局的好办法


836
00:38:44,992 --> 00:38:48,295
在所有设备和尺寸
均可适用


837
00:38:48,795 --> 00:38:52,332
如果适当激活
并关闭约束的话 


838
00:38:52,399 --> 00:38:54,468
大家都可以使用
可以获得动态


839
00:38:54,535 --> 00:38:58,138
有趣的布局 
而在每个屏幕上


840
00:38:58,205 --> 00:39:00,073iddle
无需太多设计工作


841
00:38:58,205 --> 00:39:00,073
无需太多设计工作


842
00:39:01,175 --> 00:39:05,179
决定具体尺寸后 
使用约束


843
00:39:05,712 --> 00:39:11,084
当绝对必要时 
可以覆盖内部内容尺寸


844
00:39:11,151 --> 00:39:14,488
使用优先级
实现最后的小调整


845
00:39:15,055 --> 00:39:17,991
最后 可以不仅仅做顶部
底部和居中对齐


846
00:39:18,192 --> 00:39:20,627
特别是当你看着文本 
考虑进行本地化


847
00:39:20,694 --> 00:39:22,329
和动态文本时更是如此


848
00:39:22,930 --> 00:39:24,965
若想了解
更多详情


849
00:39:25,032 --> 00:39:26,767
我们还有部分文档资料


850
00:39:27,201 --> 00:39:29,603
如果想试试动画效果
可以下载


851
00:39:29,670 --> 00:39:32,272
这些行星示例代码
当然 也可以


852
00:39:32,339 --> 00:39:36,844
前往论坛或者
索性联系我们的开发顾问


853
00:39:37,177 --> 00:39:40,247
下午
是《Auto Layout谜题》


854
00:39:40,314 --> 00:39:43,150
第二部分内容会深度介绍布局周期
的内容以及更多


855
00:39:43,483 --> 00:39:47,621
关于不符合预期的布局
调试内容


856
00:39:47,688 --> 00:39:49,590
我们还有其他的
相关讲座


857
00:39:50,090 --> 00:39:51,892
祝大家过得愉快
谢谢

